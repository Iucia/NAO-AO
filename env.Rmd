---
title: "Encironmental Expl"
subtitle: "ordination clustering outliers"
author: "Lucia Campese"
date: "January 2021"
output:
  html_document:
    code_folding: hide
---

  ```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<style>
.column-left{
  float: left;
  width: 50%;
  text-align: left;
}
.column-right{
  float: right;
  width: 50%;
  text-align: right;
}
</style>
  
<br>

### Aim
The aim is to characterize the study site from an environmental point of view using ordination and clustering methods, to provide an overview of relationships between objects and variables. This is a starting point since it allows to note trends, groupings, key variables, and potential outliers.

The results of this step will be 
1. compared to what we expect from current knowledge of oceanic currents and in terms of salinity, temperature, nutrients;
2. compared to patterns in OTUs/genes.


<br>

### Dataset
##### Data: TARA Oceans and Tara Oceans Polar circle environmental data
##### Taxon: none; only environmental data
##### Study site: Atlantic and Arctic Ocean stations (from station 143 to 196)


```{r warning=FALSE, message=FALSE, cache=TRUE, fig.align='center'}

library(tidyverse)
data("wrld_simpl", package = "maptools")
x_lines <- seq(-120,180, by = 60)
env_arctic <- readxl::read_xlsx("C:/Users/Userszn/Documents/PhD/script/NAO_AO_transition/Podani/tables_byPaul/Env_arctic.xlsx")

env_arctic_2 <- env_arctic %>% 
  filter(Station %in% c(143:196))

ggplot() +
  geom_polygon(data = wrld_simpl, aes(x = long, y = lat, group = group), fill = "grey", colour = "black", alpha = 0.8) +  # Convert to polar coordinates
  coord_map("ortho", orientation = c(90, 0, 0)) +
  scale_y_continuous(breaks = seq(25, 90, by = 5), labels = NULL) +  # Removes Axes and labels
  scale_x_continuous(breaks = NULL) +
  xlab("") +
  ylab("") +  # Adds labels
  geom_text(aes(x = 180, y = seq(25, 85, by = 10), hjust = -0.2, label = paste0(seq(25, 85, by = 10), "°N"))) +
  geom_text(aes(x = x_lines, y = 39, label = c("120°W", "60°W", "0°", "60°E", "120°E", "180°W"))) +  # Adds axes
  geom_hline(aes(yintercept = 25), size = 1)  +
  geom_segment(aes(y = 25, yend = 90, x = x_lines, xend = x_lines), linetype = "dashed") +  # Change theme to remove axes and ticks
  theme(panel.background = element_blank(),
        panel.grid.major = element_line(size = 0.25, linetype = 'dashed',
                                        colour = "black"),
        axis.ticks=element_blank()) +
  geom_point(aes(x=env_arctic_2$`Long,`, y=env_arctic_2$`Lat,`), shape=19, fill="blue", color="blue", size=3) +
  ggrepel::geom_label_repel(aes(x=env_arctic_2$`Long,`, y=env_arctic_2$`Lat,`, label = env_arctic_2$Station))
```



### Workflow

<br>

#### **Choosing variables**

<br>





##### a) **ff**

1. 

```{r warning=FALSE, message=FALSE, cache=TRUE, fig.align='center'}


```


The identity percentage ranges from 59.8 to 100, but almost all sequences show a value around 99% identity to the reference database.

<br>fff

2.	
